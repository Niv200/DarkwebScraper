{"topic":"SimpleProcessInjection.c","stamp":"Anonymous","time":"09 Jun 2021, 03:02:48 UTC","text":"~<span style=\"color: #339933;\">#ifdef _UNICODE</span>~<span style=\"color: #339933;\">#ifndef UNICODE</span>~<span style=\"color: #339933;\">#define UNICODE</span>~<span style=\"color: #339933;\">#endif</span>~<span style=\"color: #339933;\">#endif</span>~<span style=\"color: #339933;\">#include &lt;stdio.h&gt;</span>~<span style=\"color: #339933;\">#include &lt;windows.h&gt;</span>~<span style=\"color: #339933;\">#include &lt;tlhelp32.h&gt;</span>~<span style=\"color: #339933;\">#include &lt;stdarg.h&gt;</span>~<span style=\"color: #339933;\">#define TARGETPROCESS L\"C:\\\\Windows\\\\System32\\\\notepad.exe\"</span>~<span style=\"color: #339933;\">#define DBGLEN 512</span>~<span style=\"color: #993333;\">typedef</span> <span style=\"color: #993333;\">struct</span> BASE_RELOCATION_ENTRY~<span style=\"color: #009900;\">{</span>~<span style=\"color: #993333;\">int</span> DebugW<span style=\"color: #009900;\">(</span>LPCWSTR fmt<span style=\"color: #339933;\">,</span> ...<span style=\"color: #009900;\">)</span>~<span style=\"color: #009900;\">{</span>~<span style=\"color: #009900;\">}</span>~<span style=\"color: #808080; font-style: italic;\">/* creates a new process and gives its PID (along with handles to the thread and process) */</span>~DWORD CreateNewProcessW<span style=\"color: #009900;\">(</span>LPCWSTR lpcwProcessName<span style=\"color: #339933;\">,</span> PDWORD dwPID<span style=\"color: #339933;\">,</span> PHANDLE hThread<span style=\"color: #339933;\">,</span> PHANDLE hProcess<span style=\"color: #009900;\">)</span>~<span style=\"color: #009900;\">{</span>~<span style=\"color: #009900;\">}</span>~<span style=\"color: #808080; font-style: italic;\">/* function that will be executed by target process */</span>~DWORD InjectionEntryPoint<span style=\"color: #009900;\">(</span><span style=\"color: #993333;\">void</span><span style=\"color: #009900;\">)</span>~<span style=\"color: #009900;\">{</span>~<span style=\"color: #009900;\">}</span>~BOOL InjectProcessW<span style=\"color: #009900;\">(</span>LPCWSTR lpcwProcessName<span style=\"color: #009900;\">)</span>~<span style=\"color: #009900;\">{</span>~<span style=\"color: #009900;\">}</span>~<span style=\"color: #993333;\">int</span> main<span style=\"color: #009900;\">(</span><span style=\"color: #993333;\">void</span><span style=\"color: #009900;\">)</span>~<span style=\"color: #009900;\">{</span>~<span style=\"color: #009900;\">}</span>"}